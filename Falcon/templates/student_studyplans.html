<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartLearn - Personalized Study Plan</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <button class="back-button" onclick="goBack()">Back</button>
        <h1>Personalized Study Plan</h1>
        <div class="study-plan-form">
            <div class="form-group">
                <label for="subjects">Subjects (comma-separated):</label>
                <input type="text" id="subjects" placeholder="Math, Science, History">
            </div>
            <div class="form-group">
                <label for="available-time">Available study time per day (hours):</label>
                <input type="number" id="available-time" min="1" max="24" value="2">
            </div>
            <div class="form-group">
                <label for="goal">Study goal:</label>
                <input type="text" id="goal" placeholder="Prepare for final exams">
            </div>
            <div class="form-group">
                <label for="area-lag">Areas of Lag (comma-separated):</label>
                <input type="text" id="area-lag" placeholder="Algebra, Thermodynamics">
            </div>
            <div class="form-group">
                <label for="learning-style">Preferred learning style:</label>
                <select id="learning-style">
                    <option value="visual">Visual</option>
                    <option value="auditory">Auditory</option>
                    <option value="reading">Reading/Writing</option>
                    <option value="kinesthetic">Kinesthetic</option>
                </select>
            </div>
            <button onclick="generateStudyPlan()">Generate Study Plan</button>
        </div>
        <div class="chat-container">
            <div id="chat-messages" class="chat-messages"></div>
        </div>
    </div>

    <script>
        const chatMessages = document.getElementById('chat-messages');

        function addMessage(content, isUser) {
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${isUser ? 'user-message' : 'ai-message'}`;
    messageDiv.innerHTML = content; // Use innerHTML to render HTML tags
    chatMessages.appendChild(messageDiv);
    chatMessages.scrollTop = chatMessages.scrollHeight;
}

        function generateStudyPlan() {
            const subjects = document.getElementById('subjects').value;
            const availableTime = document.getElementById('available-time').value;
            const goal = document.getElementById('goal').value;
            const areaLag = document.getElementById('area-lag').value;
            const learningStyle = document.getElementById('learning-style').value;

            const userInput = `Subjects: ${subjects}, Available time: ${availableTime} hours, Goal: ${goal}, Areas of Lag: ${areaLag}, Learning style: ${learningStyle}`;
            addMessage(`Generating study plan for: ${userInput}`, true);

            // API call to Flask backend
            fetch('/generate_study_plan', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    subjects: subjects,
                    hours: availableTime,
                    areaLag: areaLag,
                    goal: goal,
                    learningStyle: learningStyle
                })
            })
            .then(response => response.json())
            .then(data => {
                addMessage(data.study_plan, false);
            })
            .catch(error => {
                addMessage('Error generating study plan. Please try again.', false);
                console.error('Error:', error);
            });
        }

        // Initial message
        addMessage("Welcome! Fill out the form above to generate your personalized study plan.", false);

        function goBack() {
            window.history.back();
        }
    </script>
</body>
</html>
